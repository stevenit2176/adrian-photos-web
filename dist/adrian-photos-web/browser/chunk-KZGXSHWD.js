import{a as Q}from"./chunk-6KL2AY5X.js";import{a as j}from"./chunk-IKZ2LOK2.js";import"./chunk-ZAQJCETW.js";import{a as J,b as rt,c as ct,d as st,e as pt}from"./chunk-K2GLQ4GK.js";import{a as dt,b as lt}from"./chunk-JEGDFQ3A.js";import{a as at}from"./chunk-2DB5WL3Y.js";import{a as X,h as Y}from"./chunk-Z7H67QOJ.js";import{a as N,b as L,c as R,d as U,e as G,f as H,h as K}from"./chunk-PDGJ2ZUN.js";import"./chunk-RYSAEJIT.js";import"./chunk-4TETIUZD.js";import{d as Z,h as $,l as tt,n as et,q as nt,r as it,u as ot}from"./chunk-UYB4FCO3.js";import"./chunk-52PBV3KU.js";import{$b as E,$c as q,Db as w,Ia as d,Ja as i,Ka as n,La as b,Mb as I,Nb as z,R as _,S as g,Sa as x,Ua as u,Ub as k,Wa as l,Yc as V,_c as F,ad as A,bc as T,bd as W,cc as D,fa as O,fc as B,ga as o,ib as r,jb as h,kb as C,lb as S,ma as f,mb as P,nb as M,ob as v,qa as y,va as m}from"./chunk-KLI6WXR5.js";function gt(e,s){if(e&1){let t=x();i(0,"div",5)(1,"mat-icon"),r(2,"error"),n(),i(3,"h2"),r(4),n(),i(5,"button",6),u("click",function(){_(t);let a=l(2);return g(a.goBack())}),r(6," Back to Gallery "),n()()}if(e&2){let t=l(2);o(4),h(t.error)}}function ft(e,s){e&1&&(i(0,"span"),r(1,", "),n())}function ht(e,s){if(e&1&&(i(0,"span"),r(1),m(2,ft,2,0,"span",26),n()),e&2){let t=s.$implicit,c=s.last;o(),C(" ",t),o(),d("ngIf",!c)}}function ut(e,s){if(e&1&&(i(0,"mat-option",27),r(1),n()),e&2){let t=s.$implicit;d("value",t),o(),C(" ",t.name," ")}}function xt(e,s){if(e&1&&(i(0,"mat-option",27),r(1),n()),e&2){let t=s.$implicit,c=l(4);d("value",t),o(),S(" ",t.name," - ",c.formatPrice(t.basePrice)," ")}}function Ct(e,s){if(e&1){let t=x();i(0,"mat-form-field",17)(1,"mat-label"),r(2,"Size"),n(),i(3,"mat-select",28),v("ngModelChange",function(a){_(t);let p=l(3);return M(p.selectedSize,a)||(p.selectedSize=a),g(a)}),m(4,xt,2,3,"mat-option",19),n()()}if(e&2){let t=l(3);o(3),P("ngModel",t.selectedSize),o(),d("ngForOf",t.selectedProduct.sizes)}}function Pt(e,s){if(e&1&&(i(0,"div",33)(1,"span"),r(2),n(),i(3,"span",31),r(4),n()()),e&2){let t=l(4);o(2),C("Total (",t.quantity," items):"),o(2),h(t.formatPrice(t.selectedSize.basePrice*t.quantity))}}function Mt(e,s){if(e&1&&(i(0,"div",29)(1,"div",30)(2,"span"),r(3,"Price:"),n(),i(4,"span",31),r(5),n()(),m(6,Pt,5,2,"div",32),n()),e&2){let t=l(3);o(5),h(t.formatPrice(t.selectedSize.basePrice)),o(),d("ngIf",t.quantity>1)}}function vt(e,s){if(e&1){let t=x();i(0,"div",7)(1,"button",8),u("click",function(){_(t);let a=l(2);return g(a.goBack())}),i(2,"mat-icon"),r(3,"arrow_back"),n()(),i(4,"div",9)(5,"div",10),b(6,"img",11),n(),i(7,"div",12)(8,"mat-card",13)(9,"mat-card-header")(10,"mat-card-title"),r(11),n(),i(12,"mat-card-subtitle"),m(13,ht,3,2,"span",14),n()(),i(14,"mat-card-content")(15,"p",15),r(16),n(),i(17,"div",16)(18,"h3"),r(19,"Select Product & Size"),n(),i(20,"mat-form-field",17)(21,"mat-label"),r(22,"Product Type"),n(),i(23,"mat-select",18),v("ngModelChange",function(a){_(t);let p=l(2);return M(p.selectedProduct,a)||(p.selectedProduct=a),g(a)}),u("selectionChange",function(){_(t);let a=l(2);return g(a.onProductChange())}),m(24,ut,2,2,"mat-option",19),n()(),m(25,Ct,5,2,"mat-form-field",20),i(26,"mat-form-field",21)(27,"mat-label"),r(28,"Quantity"),n(),i(29,"input",22),v("ngModelChange",function(a){_(t);let p=l(2);return M(p.quantity,a)||(p.quantity=a),g(a)}),n()(),m(30,Mt,7,2,"div",23),n()(),i(31,"mat-card-actions")(32,"button",24),u("click",function(){_(t);let a=l(2);return g(a.addToCart())}),i(33,"mat-icon"),r(34,"add_shopping_cart"),n(),r(35," Add to Cart "),n(),i(36,"button",25),r(37," Continue Shopping "),n()()()()()()}if(e&2){let t=l(2);o(6),d("src",t.getPhotoUrl(),O)("alt",t.photo.title),o(5),h(t.photo.title),o(2),d("ngForOf",t.photo.categoryNames),o(3),h(t.photo.description),o(7),P("ngModel",t.selectedProduct),o(),d("ngForOf",t.products),o(),d("ngIf",t.selectedProduct),o(4),P("ngModel",t.quantity),o(),d("ngIf",t.selectedSize),o(2),d("disabled",!t.canAddToCart())}}function Ot(e,s){if(e&1&&(i(0,"div",2),m(1,gt,7,1,"div",3)(2,vt,38,11,"div",4),n()),e&2){let t=l();o(),d("ngIf",t.error),o(),d("ngIf",t.photo&&!t.error)}}function yt(e,s){e&1&&(i(0,"div",34)(1,"mat-icon",35),r(2,"refresh"),n(),i(3,"p"),r(4,"Loading photo..."),n()())}var Kt=(()=>{class e{route;router;photoService;cartService;snackBar;cdr;photo=null;products=[];selectedProduct=null;selectedSize=null;quantity=1;loading=!0;error=null;constructor(t,c,a,p,mt,_t){this.route=t,this.router=c,this.photoService=a,this.cartService=p,this.snackBar=mt,this.cdr=_t}ngOnInit(){let t=this.route.snapshot.paramMap.get("id");t?(this.loadPhoto(t),this.loadProducts()):(this.error="Photo ID not found",this.loading=!1)}loadPhoto(t){this.photoService.getPhotoById(t).subscribe({next:c=>{this.photo=c,this.loading=!1,this.cdr.detectChanges()},error:c=>{this.error="Failed to load photo",this.loading=!1,this.cdr.detectChanges(),console.error("Error loading photo:",c)}})}loadProducts(){this.photoService.getProducts().subscribe({next:t=>{this.products=t,t.length>0&&(this.selectedProduct=t[0],t[0].sizes&&t[0].sizes.length>0&&(this.selectedSize=t[0].sizes[0]))},error:t=>{console.error("Error loading products:",t)}})}onProductChange(){this.selectedProduct&&this.selectedProduct.sizes.length>0?this.selectedSize=this.selectedProduct.sizes[0]:this.selectedSize=null}getPhotoUrl(){return this.photo?this.photoService.getPhotoUrl(this.photo.r2Key):""}formatPrice(t){return`$${(t/100).toFixed(2)}`}canAddToCart(){return!!(this.photo&&this.selectedProduct&&this.selectedSize&&this.quantity>0)}addToCart(){!this.canAddToCart()||!this.photo||!this.selectedProduct||!this.selectedSize||(this.cartService.addItem({photoId:this.photo.id,photoTitle:this.photo.title,photoThumbnail:this.getPhotoUrl(),productTypeId:this.selectedProduct.id,productTypeName:this.selectedProduct.name,productSizeId:this.selectedSize.id,productSizeName:this.selectedSize.name,unitPrice:this.selectedSize.basePrice,quantity:this.quantity}),this.snackBar.open("Added to cart!","View Cart",{duration:3e3,horizontalPosition:"end",verticalPosition:"top"}).onAction().subscribe(()=>{this.router.navigate(["/cart"])}))}goBack(){this.router.navigate(["/gallery"])}static \u0275fac=function(c){return new(c||e)(f(E),f(T),f(Q),f(j),f(st),f(w))};static \u0275cmp=y({type:e,selectors:[["app-photo-detail"]],decls:2,vars:2,consts:[["class","photo-detail-container",4,"ngIf"],["class","loading",4,"ngIf"],[1,"photo-detail-container"],["class","error-message",4,"ngIf"],["class","photo-detail",4,"ngIf"],[1,"error-message"],["mat-raised-button","","color","primary",3,"click"],[1,"photo-detail"],["mat-icon-button","",1,"back-button",3,"click"],[1,"photo-content"],[1,"photo-image-section"],[1,"photo-image",3,"src","alt"],[1,"photo-info-section"],[1,"info-card"],[4,"ngFor","ngForOf"],[1,"description"],[1,"product-selection"],["appearance","outline",1,"full-width"],[3,"ngModelChange","selectionChange","ngModel"],[3,"value",4,"ngFor","ngForOf"],["appearance","outline","class","full-width",4,"ngIf"],["appearance","outline",1,"quantity-field"],["matInput","","type","number","min","1","max","99",3,"ngModelChange","ngModel"],["class","price-summary",4,"ngIf"],["mat-raised-button","","color","primary",1,"add-to-cart-btn",3,"click","disabled"],["mat-button","","routerLink","/gallery"],[4,"ngIf"],[3,"value"],[3,"ngModelChange","ngModel"],[1,"price-summary"],[1,"price-row"],[1,"price"],["class","price-row total",4,"ngIf"],[1,"price-row","total"],[1,"loading"],[1,"spinner"]],template:function(c,a){c&1&&m(0,Ot,3,2,"div",0)(1,yt,5,0,"div",1),c&2&&(d("ngIf",!a.loading),o(),d("ngIf",a.loading))},dependencies:[k,I,z,B,D,ot,Z,et,$,it,nt,tt,K,N,G,R,H,U,L,q,F,V,W,A,ct,Y,X,rt,J,at,lt,dt,pt],styles:[".photo-detail-container[_ngcontent-%COMP%]{min-height:calc(100vh - 64px);background:#f5f7fa;padding:40px 20px}.back-button[_ngcontent-%COMP%]{position:fixed;top:80px;left:20px;background:#fff;box-shadow:0 2px 8px #0000001a;z-index:10}.back-button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{color:#616e76}.error-message[_ngcontent-%COMP%]{text-align:center;padding:80px 20px}.error-message[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:80px;width:80px;height:80px;color:#f44336;margin-bottom:20px}.error-message[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-family:Prata,serif;color:#616e76;margin:0 0 24px}.photo-detail[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto}.photo-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 500px;gap:40px;align-items:start}.photo-image-section[_ngcontent-%COMP%]{background:#fff;border-radius:8px;overflow:hidden;box-shadow:0 4px 16px #0000001a}.photo-image-section[_ngcontent-%COMP%]   .photo-image[_ngcontent-%COMP%]{width:100%;height:auto;display:block}.photo-info-section[_ngcontent-%COMP%]{position:sticky;top:80px}.info-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]{margin-bottom:24px}.info-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-family:Prata,serif;font-size:32px;color:#616e76;margin-bottom:8px}.info-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-subtitle[_ngcontent-%COMP%]{font-family:Barlow,sans-serif;font-size:16px;color:#999;text-transform:uppercase;letter-spacing:1px}.info-card[_ngcontent-%COMP%]   .description[_ngcontent-%COMP%]{font-family:Barlow,sans-serif;font-size:16px;line-height:1.6;color:#666;margin-bottom:32px}.info-card[_ngcontent-%COMP%]   .product-selection[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-family:Prata,serif;font-size:20px;color:#616e76;margin:0 0 20px}.info-card[_ngcontent-%COMP%]   .product-selection[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}.info-card[_ngcontent-%COMP%]   .product-selection[_ngcontent-%COMP%]   .quantity-field[_ngcontent-%COMP%]{width:120px}.info-card[_ngcontent-%COMP%]   .product-selection[_ngcontent-%COMP%]   .quantity-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{font-family:Barlow,sans-serif;font-weight:600}.info-card[_ngcontent-%COMP%]   .price-summary[_ngcontent-%COMP%]{margin:24px 0;padding:20px;background:#f5f7fa;border-radius:8px}.info-card[_ngcontent-%COMP%]   .price-summary[_ngcontent-%COMP%]   .price-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;font-family:Barlow,sans-serif;font-size:16px;color:#666;margin-bottom:12px}.info-card[_ngcontent-%COMP%]   .price-summary[_ngcontent-%COMP%]   .price-row[_ngcontent-%COMP%]:last-child{margin-bottom:0}.info-card[_ngcontent-%COMP%]   .price-summary[_ngcontent-%COMP%]   .price-row.total[_ngcontent-%COMP%]{font-size:20px;font-weight:800;color:#616e76;padding-top:12px;border-top:2px solid #e0e0e0;margin-top:12px}.info-card[_ngcontent-%COMP%]   .price-summary[_ngcontent-%COMP%]   .price-row[_ngcontent-%COMP%]   .price[_ngcontent-%COMP%]{font-weight:700;color:#616e76}.info-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;padding:16px}.info-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   .add-to-cart-btn[_ngcontent-%COMP%]{font-family:Barlow,sans-serif;font-weight:800;font-size:16px;padding:12px 24px;background-color:#e2bf55!important;color:#616e76!important}.info-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   .add-to-cart-btn[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.info-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   .add-to-cart-btn[_ngcontent-%COMP%]:disabled{background-color:#ddd!important;color:#999!important}.info-card[_ngcontent-%COMP%]   mat-card-actions[_ngcontent-%COMP%]   button[mat-button][_ngcontent-%COMP%]{font-family:Barlow,sans-serif;font-weight:600}.loading[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;min-height:400px}.loading[_ngcontent-%COMP%]   .spinner[_ngcontent-%COMP%]{font-size:60px;width:60px;height:60px;color:#616e76;animation:_ngcontent-%COMP%_spin 1s linear infinite}.loading[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-family:Barlow,sans-serif;font-size:16px;color:#999;margin-top:16px}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}@media(max-width:1024px){.photo-content[_ngcontent-%COMP%]{grid-template-columns:1fr}.photo-info-section[_ngcontent-%COMP%]{position:static}}@media(max-width:768px){.photo-detail-container[_ngcontent-%COMP%]{padding:20px 10px}.back-button[_ngcontent-%COMP%]{top:70px;left:10px}.info-card[_ngcontent-%COMP%]   mat-card-header[_ngcontent-%COMP%]   mat-card-title[_ngcontent-%COMP%]{font-size:24px}}"]})}return e})();export{Kt as PhotoDetailComponent};
