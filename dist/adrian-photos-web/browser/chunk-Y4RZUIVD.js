import{a as V}from"./chunk-TJA7MBHB.js";import{a as _}from"./chunk-5GM4WQFN.js";import{a as B,b as G}from"./chunk-PQKWKBLX.js";import{a as T,b as I,c as k,f as D,h as z}from"./chunk-AJVMF73T.js";import{Ea as g,Fb as y,Ga as m,Ia as M,Ja as P,La as e,Ma as n,Na as s,Xb as h,Ya as p,cc as v,ed as E,fc as S,fd as b,gd as w,ia as o,ib as u,jc as A,kb as t,lb as r,mb as O,oa as C,sa as f,x}from"./chunk-Z7QZQF3E.js";var L=(a,c)=>c.path;function N(a,c){a&1&&s(0,"mat-spinner",9)}function R(a,c){if(a&1&&(e(0,"div",25),t(1),n(),e(2,"div",26),t(3,"All time"),n()),a&2){let i=p();o(),r((i.analyticsStats==null||i.analyticsStats.totalVisitors==null?null:i.analyticsStats.totalVisitors.toLocaleString())||"0")}}function j(a,c){a&1&&s(0,"mat-spinner",9)}function $(a,c){if(a&1&&(e(0,"div",25),t(1),n(),e(2,"div",27),t(3,"Active engagement"),n()),a&2){let i=p();o(),r((i.analyticsStats==null||i.analyticsStats.visitorsThisWeek==null?null:i.analyticsStats.visitorsThisWeek.toLocaleString())||"0")}}function F(a,c){a&1&&s(0,"mat-spinner",9)}function U(a,c){if(a&1&&(e(0,"div",25),t(1),n(),e(2,"div",27),t(3,"Today"),n()),a&2){let i=p();o(),r((i.analyticsStats==null||i.analyticsStats.visitorsToday==null?null:i.analyticsStats.visitorsToday.toLocaleString())||"0")}}function W(a,c){a&1&&s(0,"mat-spinner",9)}function H(a,c){if(a&1&&(e(0,"div",25),t(1),n(),e(2,"div",26),t(3,"Total views"),n()),a&2){let i=p();o(),r((i.analyticsStats==null||i.analyticsStats.pageViews==null?null:i.analyticsStats.pageViews.toLocaleString())||"0")}}function J(a,c){a&1&&s(0,"mat-spinner",9)}function K(a,c){if(a&1&&(e(0,"div",25),t(1),n(),e(2,"div",26),t(3,"Per session"),n()),a&2){let i=p();o(),r(i.formatDuration((i.analyticsStats==null?null:i.analyticsStats.avgSessionDuration)||0))}}function Y(a,c){a&1&&s(0,"mat-spinner",9)}function q(a,c){if(a&1&&(e(0,"div",25),t(1),n(),e(2,"div",27),t(3,"This month"),n()),a&2){let i=p();o(),r((i.analyticsStats==null||i.analyticsStats.visitorsThisMonth==null?null:i.analyticsStats.visitorsThisMonth.toLocaleString())||"0")}}function Q(a,c){if(a&1&&(e(0,"div",29)(1,"span",30),t(2),n(),e(3,"span",31),t(4),n()()),a&2){let i=c.$implicit;o(2),r(i.path),o(2),O("",i.views.toLocaleString()," views")}}function X(a,c){if(a&1&&(e(0,"mat-card",15)(1,"mat-card-header")(2,"mat-card-title"),t(3,"Top Pages"),n()(),e(4,"mat-card-content")(5,"div",28),M(6,Q,5,2,"div",29,L),n()()()),a&2){let i=p();o(6),P(i.analyticsStats.topPages)}}var pt=(()=>{class a{analyticsService;router;cdr;analyticsStats=null;loadingAnalytics=!0;routerSubscription;isInitialLoad=!0;measurementId=_.ga4MeasurementId;propertyId="523127739";apiSecretConfigured=!!_.ga4ApiSecret;constructor(i,d,l){this.analyticsService=i,this.router=d,this.cdr=l}ngOnInit(){this.loadAnalytics(),this.routerSubscription=this.router.events.pipe(x(i=>i instanceof v)).subscribe(i=>{if(this.isInitialLoad){this.isInitialLoad=!1;return}i.urlAfterRedirects.includes("/admin/analytics")&&(console.log("[Analytics] Analytics route detected, reloading analytics"),this.loadAnalytics())})}ngOnDestroy(){this.routerSubscription?.unsubscribe()}loadAnalytics(){this.loadingAnalytics=!0,this.cdr.detectChanges(),this.analyticsService.getStats().subscribe({next:i=>{this.analyticsStats=i,this.loadingAnalytics=!1,this.cdr.detectChanges()},error:i=>{console.error("Error loading analytics:",i),this.loadingAnalytics=!1,this.cdr.detectChanges()}})}formatDuration(i){let d=Math.floor(i/60),l=i%60;return`${d}m ${l}s`}static \u0275fac=function(d){return new(d||a)(C(V),C(S),C(y))};static \u0275cmp=f({type:a,selectors:[["app-admin-analytics"]],decls:152,vars:12,consts:[[1,"admin-page","analytics"],[1,"admin-page-header"],[1,"header-content"],[1,"subtitle"],[1,"stats-grid"],[1,"stat-card","visitors"],[1,"stat-icon"],[1,"stat-info"],[1,"stat-label"],["diameter","30"],[1,"stat-card","visitors-week"],[1,"stat-card","visitors-today"],[1,"stat-card","pageviews"],[1,"stat-card","session-duration"],[1,"stat-card","visitors-month"],[1,"top-pages-card"],[1,"analytics-notice"],[1,"notice-content"],[1,"notice-icon"],[1,"notice-text"],[1,"setup-note"],[1,"setup-steps"],["href","https://analytics.google.com","target","_blank"],[1,"current-config"],[1,"status-badge"],[1,"stat-value"],[1,"stat-change","neutral"],[1,"stat-change","positive"],[1,"page-list"],[1,"page-item"],[1,"page-path"],[1,"page-views"]],template:function(d,l){d&1&&(e(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1"),t(4,"Analytics"),n(),e(5,"p",3),t(6,"Detailed insights into site traffic, user behavior, and sales performance."),n()()(),e(7,"div",4)(8,"mat-card",5)(9,"mat-card-content")(10,"div",6)(11,"mat-icon"),t(12,"people"),n()(),e(13,"div",7)(14,"div",8),t(15,"Total Visitors"),n(),g(16,N,1,0,"mat-spinner",9)(17,R,4,1),n()()(),e(18,"mat-card",10)(19,"mat-card-content")(20,"div",6)(21,"mat-icon"),t(22,"trending_up"),n()(),e(23,"div",7)(24,"div",8),t(25,"Visitors This Week"),n(),g(26,j,1,0,"mat-spinner",9)(27,$,4,1),n()()(),e(28,"mat-card",11)(29,"mat-card-content")(30,"div",6)(31,"mat-icon"),t(32,"today"),n()(),e(33,"div",7)(34,"div",8),t(35,"Visitors Today"),n(),g(36,F,1,0,"mat-spinner",9)(37,U,4,1),n()()(),e(38,"mat-card",12)(39,"mat-card-content")(40,"div",6)(41,"mat-icon"),t(42,"visibility"),n()(),e(43,"div",7)(44,"div",8),t(45,"Page Views"),n(),g(46,W,1,0,"mat-spinner",9)(47,H,4,1),n()()(),e(48,"mat-card",13)(49,"mat-card-content")(50,"div",6)(51,"mat-icon"),t(52,"access_time"),n()(),e(53,"div",7)(54,"div",8),t(55,"Avg. Session Duration"),n(),g(56,J,1,0,"mat-spinner",9)(57,K,4,1),n()()(),e(58,"mat-card",14)(59,"mat-card-content")(60,"div",6)(61,"mat-icon"),t(62,"calendar_month"),n()(),e(63,"div",7)(64,"div",8),t(65,"Visitors This Month"),n(),g(66,Y,1,0,"mat-spinner",9)(67,q,4,1),n()()()(),g(68,X,8,0,"mat-card",15),e(69,"mat-card",16)(70,"mat-card-content")(71,"div",17)(72,"mat-icon",18),t(73,"info"),n(),e(74,"div",19)(75,"h3"),t(76,"Google Analytics Tracking Active"),n(),e(77,"p")(78,"strong"),t(79,"Current Status:"),n(),t(80," Using Google Analytics 4 Measurement Protocol to track user behavior in real-time. "),n(),e(81,"p")(82,"strong"),t(83,"Tracked Events:"),n(),t(84," Page views, Add to cart, Purchases (when implemented) "),n(),e(85,"p",20),t(86," \u{1F4CA} "),e(87,"strong"),t(88,"Note:"),n(),t(89," The analytics shown above are currently "),e(90,"strong"),t(91,"mock data"),n(),t(92," for development purposes. To view real Google Analytics data, you'll need to configure the Google Analytics Data API with service account credentials. "),n(),e(93,"div",21)(94,"h4"),t(95,"To enable real-time analytics data:"),n(),e(96,"ol")(97,"li")(98,"strong"),t(99,"Get a Measurement Protocol API Secret:"),n(),e(100,"ul")(101,"li"),t(102,"Go to "),e(103,"a",22),t(104,"Google Analytics"),n()(),e(105,"li"),t(106,"Navigate to Admin \u2192 Data Streams \u2192 Select your web stream"),n(),e(107,"li"),t(108,'Click "Measurement Protocol API secrets"'),n(),e(109,"li"),t(110,"Create a new API secret and copy it"),n()()(),e(111,"li")(112,"strong"),t(113,"Update Environment:"),n(),t(114," Set "),e(115,"code"),t(116,"ga4ApiSecret"),n(),t(117," in "),e(118,"code"),t(119,"src/environments/environment.prod.ts"),n()(),e(120,"li")(121,"strong"),t(122,"Optional - For Dashboard Data Retrieval:"),n(),e(123,"ul")(124,"li"),t(125,"Create a Google Cloud Service Account with Analytics Read permissions"),n(),e(126,"li"),t(127,"Download the JSON credentials"),n(),e(128,"li"),t(129,"Set "),e(130,"code"),t(131,"GA4_SERVICE_ACCOUNT_KEY"),n(),t(132," in Cloudflare Pages environment variables"),n(),e(133,"li"),t(134,"Implement REST API calls to Google Analytics Data API in "),e(135,"code"),t(136,"functions/api/analytics/stats.ts"),n()()()()()(),e(137,"p",23)(138,"strong"),t(139,"Current Configuration:"),n(),s(140,"br"),t(141," Measurement ID: "),e(142,"code"),t(143),n(),s(144,"br"),t(145," Property ID: "),e(146,"code"),t(147),n(),s(148,"br"),t(149," API Secret: "),e(150,"span",24),t(151),n()()()()()()()),d&2&&(o(16),m(l.loadingAnalytics?16:17),o(10),m(l.loadingAnalytics?26:27),o(10),m(l.loadingAnalytics?36:37),o(10),m(l.loadingAnalytics?46:47),o(10),m(l.loadingAnalytics?56:57),o(10),m(l.loadingAnalytics?66:67),o(2),m(!l.loadingAnalytics&&l.analyticsStats?68:-1),o(75),r(l.measurementId),o(4),r(l.propertyId),o(3),u("configured",l.apiSecretConfigured),o(),r(l.apiSecretConfigured?"Configured \u2713":"Not Configured"))},dependencies:[h,A,z,T,k,D,I,E,w,b,G,B],styles:[".admin-page[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;padding:0}.admin-page-header[_ngcontent-%COMP%]{margin-bottom:32px;display:flex;align-items:flex-start;justify-content:space-between;gap:16px}.admin-page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{flex:1}.admin-page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:Prata,serif;font-size:36px;color:#616e76;margin:0 0 8px}.admin-page-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-family:Barlow,sans-serif;font-size:16px;color:#999;margin:0}.admin-page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center;flex-shrink:0}.admin-page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-family:Barlow,sans-serif;font-weight:800}.admin-page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.page-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:24px}.stat-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:24px!important}.stat-card[_ngcontent-%COMP%]     mat-spinner circle{stroke:#e2bf55!important}.stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{width:64px;height:64px;border-radius:12px;display:flex;align-items:center;justify-content:center}.stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px;color:#fff}.stat-card[_ngcontent-%COMP%]   .stat-info[_ngcontent-%COMP%]{flex:1}.stat-card[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-family:Barlow,sans-serif;font-size:14px;color:#999;margin-bottom:4px}.stat-card[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-family:Barlow,sans-serif;font-weight:800;font-size:32px;color:#616e76;line-height:1;margin-bottom:4px}.stat-card[_ngcontent-%COMP%]   .stat-change[_ngcontent-%COMP%]{font-family:Barlow,sans-serif;font-size:12px;font-weight:600}.stat-card[_ngcontent-%COMP%]   .stat-change.positive[_ngcontent-%COMP%]{color:#4caf50}.stat-card[_ngcontent-%COMP%]   .stat-change.neutral[_ngcontent-%COMP%]{color:#999}.stat-card[_ngcontent-%COMP%]   .stat-change.warning[_ngcontent-%COMP%]{color:#ff9800}@media(max-width:768px){.admin-page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.admin-page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:28px}.admin-page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{width:100%;flex-direction:column}.admin-page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:24px;margin-bottom:32px}.stat-card.visitors[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%], .stat-card.visitors-week[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%], .stat-card.visitors-today[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%], .stat-card.pageviews[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%], .stat-card.session-duration[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%], .stat-card.visitors-month[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{background:linear-gradient(135deg,#e2bf55,#e69e05)}.top-pages-card[_ngcontent-%COMP%]{margin-bottom:32px}.top-pages-card[_ngcontent-%COMP%]   .page-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.top-pages-card[_ngcontent-%COMP%]   .page-item[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:12px 16px;background:#f8f9fa;border-radius:6px;border-left:3px solid #e2bf55}.top-pages-card[_ngcontent-%COMP%]   .page-item[_ngcontent-%COMP%]   .page-path[_ngcontent-%COMP%]{font-family:Barlow,sans-serif;font-weight:600;color:#616e76;font-size:14px}.top-pages-card[_ngcontent-%COMP%]   .page-item[_ngcontent-%COMP%]   .page-views[_ngcontent-%COMP%]{font-family:Barlow,sans-serif;font-size:13px;color:#999;font-weight:600}.analytics-notice[_ngcontent-%COMP%]{margin-bottom:32px}.analytics-notice[_ngcontent-%COMP%]   .notice-content[_ngcontent-%COMP%]{display:flex;gap:20px;align-items:flex-start}.analytics-notice[_ngcontent-%COMP%]   .notice-content[_ngcontent-%COMP%]   .notice-icon[_ngcontent-%COMP%]{font-size:48px;width:48px;height:48px;color:#e2bf55;flex-shrink:0}.analytics-notice[_ngcontent-%COMP%]   .notice-content[_ngcontent-%COMP%]   .notice-text[_ngcontent-%COMP%]{flex:1}.analytics-notice[_ngcontent-%COMP%]   .notice-content[_ngcontent-%COMP%]   .notice-text[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-family:Prata,serif;font-size:20px;color:#616e76;margin:0 0 16px}.analytics-notice[_ngcontent-%COMP%]   .notice-content[_ngcontent-%COMP%]   .notice-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-family:Barlow,sans-serif;font-size:14px;line-height:1.6;color:#616e76;margin:0 0 12px}.analytics-notice[_ngcontent-%COMP%]   .notice-content[_ngcontent-%COMP%]   .notice-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#616e76;font-weight:600}.analytics-notice[_ngcontent-%COMP%]   .notice-content[_ngcontent-%COMP%]   .notice-text[_ngcontent-%COMP%]   .setup-note[_ngcontent-%COMP%]{background:#fff8e1;padding:12px 16px;border-radius:6px;border-left:4px solid #ffc107;margin:16px 0}.analytics-notice[_ngcontent-%COMP%]   .notice-content[_ngcontent-%COMP%]   .notice-text[_ngcontent-%COMP%]   .setup-steps[_ngcontent-%COMP%]{background:#f8f9fa;padding:16px;border-radius:6px;margin:16px 0}.analytics-notice[_ngcontent-%COMP%]   .notice-content[_ngcontent-%COMP%]   .notice-text[_ngcontent-%COMP%]   .setup-steps[_ngcontent-%COMP%]   h4[_ngcontent-%COMP%]{font-family:Barlow,sans-serif;font-size:15px;font-weight:600;color:#616e76;margin:0 0 12px}.analytics-notice[_ngcontent-%COMP%]   .notice-content[_ngcontent-%COMP%]   .notice-text[_ngcontent-%COMP%]   .setup-steps[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]{margin:0;padding-left:20px}.analytics-notice[_ngcontent-%COMP%]   .notice-content[_ngcontent-%COMP%]   .notice-text[_ngcontent-%COMP%]   .setup-steps[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{font-family:Barlow,sans-serif;font-size:14px;line-height:1.6;color:#616e76;margin-bottom:12px}.analytics-notice[_ngcontent-%COMP%]   .notice-content[_ngcontent-%COMP%]   .notice-text[_ngcontent-%COMP%]   .setup-steps[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   strong[_ngcontent-%COMP%]{color:#616e76;font-weight:600}.analytics-notice[_ngcontent-%COMP%]   .notice-content[_ngcontent-%COMP%]   .notice-text[_ngcontent-%COMP%]   .setup-steps[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]{margin-top:8px;padding-left:20px}.analytics-notice[_ngcontent-%COMP%]   .notice-content[_ngcontent-%COMP%]   .notice-text[_ngcontent-%COMP%]   .setup-steps[_ngcontent-%COMP%]   ol[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]   ul[_ngcontent-%COMP%]   li[_ngcontent-%COMP%]{margin-bottom:4px}.analytics-notice[_ngcontent-%COMP%]   .notice-content[_ngcontent-%COMP%]   .notice-text[_ngcontent-%COMP%]   .setup-steps[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background:#e2bf55;color:#1a1a1a;padding:2px 6px;border-radius:3px;font-family:Courier New,monospace;font-size:13px}.analytics-notice[_ngcontent-%COMP%]   .notice-content[_ngcontent-%COMP%]   .notice-text[_ngcontent-%COMP%]   .setup-steps[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:#e2bf55;font-weight:600;text-decoration:none}.analytics-notice[_ngcontent-%COMP%]   .notice-content[_ngcontent-%COMP%]   .notice-text[_ngcontent-%COMP%]   .setup-steps[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{text-decoration:underline}.analytics-notice[_ngcontent-%COMP%]   .notice-content[_ngcontent-%COMP%]   .notice-text[_ngcontent-%COMP%]   .current-config[_ngcontent-%COMP%]{background:#e8f5e9;padding:12px 16px;border-radius:6px;border-left:4px solid #4caf50;margin-top:16px}.analytics-notice[_ngcontent-%COMP%]   .notice-content[_ngcontent-%COMP%]   .notice-text[_ngcontent-%COMP%]   .current-config[_ngcontent-%COMP%]   code[_ngcontent-%COMP%]{background:#c8e6c9;padding:2px 6px;border-radius:3px;font-family:Courier New,monospace;font-size:13px}.analytics-notice[_ngcontent-%COMP%]   .notice-content[_ngcontent-%COMP%]   .notice-text[_ngcontent-%COMP%]   .current-config[_ngcontent-%COMP%]   .status-badge[_ngcontent-%COMP%]{display:inline-block;padding:2px 8px;border-radius:12px;font-size:12px;font-weight:600;background:#ff9800;color:#fff}.analytics-notice[_ngcontent-%COMP%]   .notice-content[_ngcontent-%COMP%]   .notice-text[_ngcontent-%COMP%]   .current-config[_ngcontent-%COMP%]   .status-badge.configured[_ngcontent-%COMP%]{background:#4caf50}@media(max-width:768px){.stats-grid[_ngcontent-%COMP%]{grid-template-columns:1fr}.analytics-notice[_ngcontent-%COMP%]   .notice-content[_ngcontent-%COMP%]{flex-direction:column}}"]})}return a})();export{pt as AdminAnalyticsComponent};
