import{a as he,b as Ce}from"./chunk-2VCUM55J.js";import{b as ue,c as _e}from"./chunk-6TRJIED5.js";import{a as L}from"./chunk-YUITIWFT.js";import{c as se}from"./chunk-BDZSJOAO.js";import{a as R}from"./chunk-5GM4WQFN.js";import{a as ge,b as fe}from"./chunk-7VV2ICZJ.js";import{a as de,b as me}from"./chunk-TOKWQDRS.js";import{a as pe}from"./chunk-6DQ7DRGO.js";import{b as W,c as K,d as Q,i as X}from"./chunk-YRW4GBFK.js";import{a as $,c as H,h as J}from"./chunk-AJVMF73T.js";import"./chunk-NLFWUB3B.js";import"./chunk-4GZB6F7U.js";import"./chunk-HBOHSLSL.js";import{c as Y,e as h,g as Z,h as ee,j as te,l as ne,m as oe,n as ie,o as re,q as ae,s as le,u as ce}from"./chunk-PMF3TIP7.js";import"./chunk-KMGLOWHO.js";import{$b as V,Ka as p,La as o,Ma as n,Na as P,Ob as z,Pb as U,T as m,U as g,Ua as O,Wa as _,Xb as B,Ya as M,_b as v,bd as N,d as F,dd as A,ed as j,fc as T,fd as G,gb as E,gd as q,ha as S,ia as c,ib as I,jc as D,kb as a,mb as b,oa as C,sa as k,xa as u}from"./chunk-Z7QZQF3E.js";function Pe(r,f){r&1&&(o(0,"div",27)(1,"mat-icon",28),a(2,"cloud_upload"),n(),o(3,"h3"),a(4,"Drag & Drop Photo Here"),n(),o(5,"p"),a(6,"or click to browse"),n(),o(7,"p",29),a(8,"Supported: JPEG, PNG, WebP, GIF (Max 10MB)"),n()())}function Me(r,f){if(r&1){let e=O();o(0,"div",30),P(1,"img",31),o(2,"button",32),_("click",function(t){return m(e),M().removeFile(),g(t.stopPropagation())}),o(3,"mat-icon"),a(4,"close"),n()()()}if(r&2){let e=M();c(),p("src",e.imagePreview,S)}}function xe(r,f){r&1&&(o(0,"mat-error"),a(1," Title is required "),n())}function Oe(r,f){r&1&&(o(0,"mat-error"),a(1," Title must be at least 3 characters "),n())}function be(r,f){r&1&&(o(0,"mat-error"),a(1," Description is required "),n())}function ve(r,f){r&1&&(o(0,"mat-error"),a(1," Description must be at least 10 characters "),n())}function ye(r,f){if(r&1){let e=O();o(0,"mat-checkbox",33),_("change",function(t){let l=m(e).$implicit,s=M();return g(s.onCategoryChange(l.id,t.checked))}),a(1),n()}if(r&2){let e=f.$implicit,i=M();p("checked",i.isCategorySelected(e.id)),c(),b(" ",e.name," ")}}function we(r,f){r&1&&(o(0,"mat-error"),a(1," At least one category is required "),n())}function Fe(r,f){r&1&&(o(0,"mat-error"),a(1," Price must be 0 or greater "),n())}function Se(r,f){if(r&1&&(o(0,"div",34)(1,"p"),a(2),n(),P(3,"mat-progress-bar",35),n()),r&2){let e=M();c(2),b("Uploading... ",e.uploadProgress,"%"),c(),p("value",e.uploadProgress)}}var ot=(()=>{class r{fb;http;categoryService;snackBar;router;uploadForm;categories=[];selectedFile=null;imagePreview=null;isDragging=!1;isUploading=!1;uploadProgress=0;constructor(e,i,t,l,s){this.fb=e,this.http=i,this.categoryService=t,this.snackBar=l,this.router=s,this.uploadForm=this.fb.group({title:["",[h.required,h.minLength(3)]],description:["",[h.required,h.minLength(10)]],categoryIds:this.fb.array([],h.required),price:[0,[h.min(0)]]})}ngOnInit(){this.loadCategories()}loadCategories(){this.categoryService.getCategories().subscribe({next:e=>{this.categories=e},error:e=>{this.snackBar.open("Failed to load categories","Close",{duration:3e3}),console.error("Error loading categories:",e)}})}get categoryIdsArray(){return this.uploadForm.get("categoryIds")}onCategoryChange(e,i){if(i)this.categoryIdsArray.push(new te(e));else{let t=this.categoryIdsArray.controls.findIndex(l=>l.value===e);this.categoryIdsArray.removeAt(t)}}isCategorySelected(e){return this.categoryIdsArray.value.includes(e)}onDragOver(e){e.preventDefault(),e.stopPropagation(),this.isDragging=!0}onDragLeave(e){e.preventDefault(),e.stopPropagation(),this.isDragging=!1}onDrop(e){e.preventDefault(),e.stopPropagation(),this.isDragging=!1;let i=e.dataTransfer?.files;i&&i.length>0&&this.handleFile(i[0])}onFileSelected(e){let i=e.target;i.files&&i.files.length>0&&this.handleFile(i.files[0])}handleFile(e){if(!["image/jpeg","image/jpg","image/png","image/webp","image/gif"].includes(e.type)){this.snackBar.open("Please select a valid image file (JPEG, PNG, WebP, or GIF)","Close",{duration:4e3});return}let t=10*1024*1024;if(e.size>t){this.snackBar.open("File size must be less than 10MB","Close",{duration:4e3});return}this.selectedFile=e;let l=new FileReader;l.onload=s=>{this.imagePreview=s.target?.result},l.readAsDataURL(e)}removeFile(){this.selectedFile=null,this.imagePreview=null}canSubmit(){return this.uploadForm.valid&&!!this.selectedFile&&!this.isUploading}onSubmit(){return F(this,null,function*(){if(!this.canSubmit()||!this.selectedFile)return;this.isUploading=!0,this.uploadProgress=0;let e=new FormData;e.append("file",this.selectedFile),e.append("title",this.uploadForm.value.title),e.append("description",this.uploadForm.value.description),e.append("categoryIds",JSON.stringify(this.uploadForm.value.categoryIds)),e.append("price",this.uploadForm.value.price.toString()),this.http.post(`${R.apiUrl}/photos/upload`,e,{reportProgress:!0,observe:"events"}).subscribe({next:i=>{i.type===v.UploadProgress?this.uploadProgress=Math.round(100*i.loaded/(i.total||1)):i.type===v.Response&&(this.snackBar.open("Photo uploaded successfully!","View",{duration:5e3}).onAction().subscribe(()=>{this.router.navigate(["/admin/photos"])}),this.resetForm())},error:i=>{console.error("Upload error:",i);let t=i.error?.error?.message||"Failed to upload photo";this.snackBar.open(t,"Close",{duration:5e3}),this.isUploading=!1,this.uploadProgress=0}})})}resetForm(){this.uploadForm.reset({price:0}),this.categoryIdsArray.clear(),this.selectedFile=null,this.imagePreview=null,this.isUploading=!1,this.uploadProgress=0}cancel(){this.router.navigate(["/admin/photos"])}static \u0275fac=function(i){return new(i||r)(C(le),C(V),C(L),C(ge),C(T))};static \u0275cmp=k({type:r,selectors:[["app-photo-upload"]],decls:54,vars:17,consts:[["fileInput",""],[1,"admin-page"],[1,"admin-page-header"],[1,"header-content"],[1,"subtitle"],[1,"header-actions"],["mat-button","",3,"click"],[1,"page-content"],[1,"upload-card"],[1,"drop-zone",3,"dragover","dragleave","drop","click"],["class","drop-zone-content",4,"ngIf"],["class","preview-container",4,"ngIf"],["type","file","accept","image/jpeg,image/jpg,image/png,image/webp,image/gif",2,"display","none",3,"change"],[1,"upload-form",3,"ngSubmit","formGroup"],["appearance","outline",1,"full-width"],["matInput","","formControlName","title","placeholder","Enter photo title"],[4,"ngIf"],["matInput","","formControlName","description","rows","4","placeholder","Enter photo description"],[1,"form-section"],[1,"section-label"],[1,"categories-checkboxes"],[3,"checked","change",4,"ngFor","ngForOf"],["matInput","","type","number","formControlName","price","min","0","placeholder","e.g., 4999 for $49.99"],["class","upload-progress",4,"ngIf"],[1,"form-actions"],["mat-raised-button","","color","primary","type","submit",3,"disabled"],["mat-button","","type","button",3,"click","disabled"],[1,"drop-zone-content"],[1,"upload-icon"],[1,"file-info"],[1,"preview-container"],["alt","Preview",1,"preview-image",3,"src"],["mat-icon-button","",1,"remove-button",3,"click"],[3,"change","checked"],[1,"upload-progress"],["mode","determinate",3,"value"]],template:function(i,t){if(i&1){let l=O();o(0,"div",1)(1,"div",2)(2,"div",3)(3,"h1"),a(4,"Upload Photo"),n(),o(5,"p",4),a(6,"Add new photos to your portfolio"),n()(),o(7,"div",5)(8,"button",6),_("click",function(){return m(l),g(t.cancel())}),o(9,"mat-icon"),a(10,"arrow_back"),n(),a(11," Back to Photos "),n()()(),o(12,"div",7)(13,"mat-card",8)(14,"mat-card-content")(15,"div",9),_("dragover",function(d){return m(l),g(t.onDragOver(d))})("dragleave",function(d){return m(l),g(t.onDragLeave(d))})("drop",function(d){return m(l),g(t.onDrop(d))})("click",function(){m(l);let d=E(19);return g(d.click())}),u(16,Pe,9,0,"div",10)(17,Me,5,1,"div",11),o(18,"input",12,0),_("change",function(d){return m(l),g(t.onFileSelected(d))}),n()(),o(20,"form",13),_("ngSubmit",function(){return m(l),g(t.onSubmit())}),o(21,"mat-form-field",14)(22,"mat-label"),a(23,"Title"),n(),P(24,"input",15),u(25,xe,2,0,"mat-error",16)(26,Oe,2,0,"mat-error",16),n(),o(27,"mat-form-field",14)(28,"mat-label"),a(29,"Description"),n(),P(30,"textarea",17),u(31,be,2,0,"mat-error",16)(32,ve,2,0,"mat-error",16),n(),o(33,"div",18)(34,"label",19),a(35,"Categories (select at least one) *"),n(),o(36,"div",20),u(37,ye,2,2,"mat-checkbox",21),n(),u(38,we,2,0,"mat-error",16),n(),o(39,"mat-form-field",14)(40,"mat-label"),a(41,"Base Price (cents)"),n(),P(42,"input",22),o(43,"mat-hint"),a(44,"Enter price in cents (e.g., 4999 = $49.99)"),n(),u(45,Fe,2,0,"mat-error",16),n(),u(46,Se,4,2,"div",23),o(47,"div",24)(48,"button",25)(49,"mat-icon"),a(50,"cloud_upload"),n(),a(51," Upload Photo "),n(),o(52,"button",26),_("click",function(){return m(l),g(t.resetForm())}),a(53," Reset "),n()()()()()()()}if(i&2){let l,s,d,y,x,w;c(15),I("dragging",t.isDragging)("has-file",t.selectedFile),c(),p("ngIf",!t.imagePreview),c(),p("ngIf",t.imagePreview),c(3),p("formGroup",t.uploadForm),c(5),p("ngIf",(l=t.uploadForm.get("title"))==null?null:l.hasError("required")),c(),p("ngIf",(s=t.uploadForm.get("title"))==null?null:s.hasError("minlength")),c(5),p("ngIf",(d=t.uploadForm.get("description"))==null?null:d.hasError("required")),c(),p("ngIf",(y=t.uploadForm.get("description"))==null?null:y.hasError("minlength")),c(5),p("ngForOf",t.categories),c(),p("ngIf",((x=t.uploadForm.get("categoryIds"))==null?null:x.hasError("required"))&&((x=t.uploadForm.get("categoryIds"))==null?null:x.touched)),c(7),p("ngIf",(w=t.uploadForm.get("price"))==null?null:w.hasError("min")),c(),p("ngIf",t.isUploading),c(2),p("disabled",!t.canSubmit()),c(4),p("disabled",t.isUploading)}},dependencies:[B,z,U,D,ce,ne,Y,oe,Z,ee,ae,re,ie,J,$,H,pe,X,W,Q,K,me,de,se,j,A,N,q,G,_e,ue,Ce,he,fe],styles:[".admin-page[_ngcontent-%COMP%]{max-width:1400px;margin:0 auto;padding:0}.admin-page-header[_ngcontent-%COMP%]{margin-bottom:32px;display:flex;align-items:flex-start;justify-content:space-between;gap:16px}.admin-page-header[_ngcontent-%COMP%]   .header-content[_ngcontent-%COMP%]{flex:1}.admin-page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-family:Prata,serif;font-size:36px;color:#616e76;margin:0 0 8px}.admin-page-header[_ngcontent-%COMP%]   .subtitle[_ngcontent-%COMP%]{font-family:Barlow,sans-serif;font-size:16px;color:#999;margin:0}.admin-page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center;flex-shrink:0}.admin-page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-family:Barlow,sans-serif;font-weight:800}.admin-page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.page-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:24px}.stat-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px;padding:24px!important}.stat-card[_ngcontent-%COMP%]     mat-spinner circle{stroke:#e2bf55!important}.stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]{width:64px;height:64px;border-radius:12px;display:flex;align-items:center;justify-content:center}.stat-card[_ngcontent-%COMP%]   .stat-icon[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{font-size:32px;width:32px;height:32px;color:#fff}.stat-card[_ngcontent-%COMP%]   .stat-info[_ngcontent-%COMP%]{flex:1}.stat-card[_ngcontent-%COMP%]   .stat-label[_ngcontent-%COMP%]{font-family:Barlow,sans-serif;font-size:14px;color:#999;margin-bottom:4px}.stat-card[_ngcontent-%COMP%]   .stat-value[_ngcontent-%COMP%]{font-family:Barlow,sans-serif;font-weight:800;font-size:32px;color:#616e76;line-height:1;margin-bottom:4px}.stat-card[_ngcontent-%COMP%]   .stat-change[_ngcontent-%COMP%]{font-family:Barlow,sans-serif;font-size:12px;font-weight:600}.stat-card[_ngcontent-%COMP%]   .stat-change.positive[_ngcontent-%COMP%]{color:#4caf50}.stat-card[_ngcontent-%COMP%]   .stat-change.neutral[_ngcontent-%COMP%]{color:#999}.stat-card[_ngcontent-%COMP%]   .stat-change.warning[_ngcontent-%COMP%]{color:#ff9800}@media(max-width:768px){.admin-page-header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start}.admin-page-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:28px}.admin-page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]{width:100%;flex-direction:column}.admin-page-header[_ngcontent-%COMP%]   .header-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{width:100%}}.admin-page[_ngcontent-%COMP%]{max-width:900px}.upload-card[_ngcontent-%COMP%]   mat-card-content[_ngcontent-%COMP%]{padding:24px}.drop-zone[_ngcontent-%COMP%]{border:3px dashed #ddd;border-radius:12px;padding:60px 20px;text-align:center;cursor:pointer;transition:all .3s ease;margin-bottom:32px;background:#fafafa;min-height:300px;display:flex;align-items:center;justify-content:center}.drop-zone[_ngcontent-%COMP%]:hover{border-color:#e2bf55;background:#fffef8}.drop-zone.dragging[_ngcontent-%COMP%]{border-color:#e2bf55;background:#fffef8;border-style:solid}.drop-zone.has-file[_ngcontent-%COMP%]{padding:20px;min-height:auto}.drop-zone[_ngcontent-%COMP%]   .drop-zone-content[_ngcontent-%COMP%]   .upload-icon[_ngcontent-%COMP%]{font-size:80px;width:80px;height:80px;color:#999;margin-bottom:16px}.drop-zone[_ngcontent-%COMP%]   .drop-zone-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-family:Prata,serif;font-size:24px;color:#616e76;margin:0 0 8px}.drop-zone[_ngcontent-%COMP%]   .drop-zone-content[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-family:Barlow,sans-serif;font-size:16px;color:#999;margin:4px 0}.drop-zone[_ngcontent-%COMP%]   .drop-zone-content[_ngcontent-%COMP%]   p.file-info[_ngcontent-%COMP%]{font-size:14px;color:#bbb;margin-top:16px}.drop-zone[_ngcontent-%COMP%]   .preview-container[_ngcontent-%COMP%]{position:relative;max-width:100%}.drop-zone[_ngcontent-%COMP%]   .preview-container[_ngcontent-%COMP%]   .preview-image[_ngcontent-%COMP%]{max-width:100%;max-height:400px;border-radius:8px;box-shadow:0 4px 8px #0000001a}.drop-zone[_ngcontent-%COMP%]   .preview-container[_ngcontent-%COMP%]   .remove-button[_ngcontent-%COMP%]{position:absolute;top:8px;right:8px;background:#0009;color:#fff}.drop-zone[_ngcontent-%COMP%]   .preview-container[_ngcontent-%COMP%]   .remove-button[_ngcontent-%COMP%]:hover{background:#000c}.upload-form[_ngcontent-%COMP%]   .full-width[_ngcontent-%COMP%]{width:100%;margin-bottom:16px}.upload-form[_ngcontent-%COMP%]   mat-form-field[_ngcontent-%COMP%]{font-family:Barlow,sans-serif}.upload-form[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]{margin:16px 0}.upload-form[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .section-label[_ngcontent-%COMP%]{display:block;font-family:Barlow,sans-serif;font-size:16px;font-weight:600;color:#616e76;margin-bottom:12px}.upload-form[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .categories-checkboxes[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(200px,1fr));gap:12px;padding:16px;border:1px solid #e0e0e0;border-radius:4px;background:#fafafa}.upload-form[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   .categories-checkboxes[_ngcontent-%COMP%]   mat-checkbox[_ngcontent-%COMP%]{font-family:Barlow,sans-serif}.upload-form[_ngcontent-%COMP%]   .form-section[_ngcontent-%COMP%]   mat-error[_ngcontent-%COMP%]{font-size:12px;color:#f44336;margin-top:4px;display:block}.upload-form[_ngcontent-%COMP%]   .upload-progress[_ngcontent-%COMP%]{margin:24px 0}.upload-form[_ngcontent-%COMP%]   .upload-progress[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-family:Barlow,sans-serif;font-weight:600;color:#616e76;margin-bottom:8px}.upload-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]{display:flex;gap:12px;margin-top:24px}.upload-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{font-family:Barlow,sans-serif;font-weight:800}.upload-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]   mat-icon[_ngcontent-%COMP%]{margin-right:8px}.upload-form[_ngcontent-%COMP%]   .form-actions[_ngcontent-%COMP%]   button[color=primary][_ngcontent-%COMP%]{background-color:#e2bf55!important;color:#616e76!important}@media(max-width:768px){.photo-upload-container[_ngcontent-%COMP%]{padding:16px}.header[_ngcontent-%COMP%]{flex-direction:column;align-items:flex-start;gap:16px}.header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{font-size:24px}.drop-zone[_ngcontent-%COMP%]{padding:40px 20px;min-height:250px}.drop-zone[_ngcontent-%COMP%]   .drop-zone-content[_ngcontent-%COMP%]   .upload-icon[_ngcontent-%COMP%]{font-size:60px;width:60px;height:60px}.drop-zone[_ngcontent-%COMP%]   .drop-zone-content[_ngcontent-%COMP%]   h3[_ngcontent-%COMP%]{font-size:20px}}"]})}return r})();export{ot as PhotoUploadComponent};
